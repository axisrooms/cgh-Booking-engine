{"ast":null,"code":"import _asyncToGenerator from \"/Users/Singanamalasharukh/Downloads/Projects/cgh-Booking-engine/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { BASE_URL, BOOKING_ENGINE_ID, getDefaultHeaders } from '../shared/constants/url.constants';\nimport { cloneDeep } from 'lodash-es';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./booking.service\";\nexport class PaymentService {\n  constructor(http, bookingService) {\n    this.http = http;\n    this.bookingService = bookingService;\n  }\n\n  createOrderAndMakePayment(bookingItem, personalDetailsForm, payathotel) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      console.log(bookingItem, personalDetailsForm, payathotel, \"!!!!!\");\n\n      _this.createOrder(bookingItem).subscribe(res1 => {\n        _this.makePayment(bookingItem, personalDetailsForm, payathotel);\n      });\n    })();\n  }\n\n  createOrder(bookingItem) {\n    let params = {\n      bookingEngineId: BOOKING_ENGINE_ID,\n      productId: bookingItem.hotelId,\n      searchId: bookingItem.searchId,\n      checkIn: bookingItem.checkIn,\n      checkOut: bookingItem.checkOut,\n      cityId: bookingItem.renderData.address.cityId,\n      paxInfo: bookingItem.paxInfo,\n      selectedrooms: `{\"1\":{\"productId\":${bookingItem.hotelId},\"roomMap\":{\"0\":{\"roomId\":${bookingItem.rooms[0].roomId},\"ratePlanId\":${bookingItem.rooms[0].ratePlanId},\"addOnMap\":{},\"addchildMap\":{},\"policyChargeScope\":{}}}}}`\n    };\n    return this.http.get(`${BASE_URL}api/be/rooms`, {\n      params: params,\n      headers: getDefaultHeaders()\n    });\n  }\n\n  makePayment(bookingItem, personalDetails, payathotel) {\n    this.bookingService.setPGLoaderFlag();\n    let item = cloneDeep(bookingItem);\n    let postpayment = personalDetails.prepayment ? bookingItem.totalAmount - personalDetails.prepayment : 0; // this.bookingService.removeCurrentBookingItemFromList()\n\n    let url1 = `https://app.axisrooms.com/beV2/hotelBooking.html?currency=1&`;\n    let url2 = `searchId=${item.searchId}&promoCodeApplied=&promoCode=&`;\n    let url3 = `tokenvalues=&master_pax_first_name=${personalDetails.firstName}&master_pax_last_name=${personalDetails.lastName}&`;\n    let url4 = `contactEmail=${personalDetails.emailId}&contactMobile=${personalDetails.mobileNo}&`;\n    let url5 = `additional_request=${personalDetails.specialRequest}&payAtHotelWithoutCC=${payathotel}&cardType=4&cardNO=&`;\n    let url6 = `cardValidity_month=&cardValidity_year=&cardHolderName=&cardValidity_cvv=&postAmountValue=` + postpayment;\n    let finalUrl = url1 + url2 + url3 + url4 + url5 + url6;\n    window.open(finalUrl, '_self');\n  }\n\n}\n\nPaymentService.ɵfac = function PaymentService_Factory(t) {\n  return new (t || PaymentService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.BookingService));\n};\n\nPaymentService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: PaymentService,\n  factory: PaymentService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/Users/Singanamalasharukh/Downloads/Projects/cgh-Booking-engine/src/app/services/payment.service.ts"],"names":["BASE_URL","BOOKING_ENGINE_ID","getDefaultHeaders","cloneDeep","i0","i1","i2","PaymentService","constructor","http","bookingService","createOrderAndMakePayment","bookingItem","personalDetailsForm","payathotel","console","log","createOrder","subscribe","res1","makePayment","params","bookingEngineId","productId","hotelId","searchId","checkIn","checkOut","cityId","renderData","address","paxInfo","selectedrooms","rooms","roomId","ratePlanId","get","headers","personalDetails","setPGLoaderFlag","item","postpayment","prepayment","totalAmount","url1","url2","url3","firstName","lastName","url4","emailId","mobileNo","url5","specialRequest","url6","finalUrl","window","open","ɵfac","PaymentService_Factory","t","ɵɵinject","HttpClient","BookingService","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import { BASE_URL, BOOKING_ENGINE_ID, getDefaultHeaders, } from '../shared/constants/url.constants';\nimport { cloneDeep } from 'lodash-es';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./booking.service\";\nexport class PaymentService {\n    constructor(http, bookingService) {\n        this.http = http;\n        this.bookingService = bookingService;\n    }\n    async createOrderAndMakePayment(bookingItem, personalDetailsForm, payathotel) {\n        console.log(bookingItem, personalDetailsForm, payathotel, \"!!!!!\");\n        this.createOrder(bookingItem).subscribe((res1) => {\n            this.makePayment(bookingItem, personalDetailsForm, payathotel);\n        });\n    }\n    createOrder(bookingItem) {\n        let params = {\n            bookingEngineId: BOOKING_ENGINE_ID,\n            productId: bookingItem.hotelId,\n            searchId: bookingItem.searchId,\n            checkIn: bookingItem.checkIn,\n            checkOut: bookingItem.checkOut,\n            cityId: bookingItem.renderData.address.cityId,\n            paxInfo: bookingItem.paxInfo,\n            selectedrooms: `{\"1\":{\"productId\":${bookingItem.hotelId},\"roomMap\":{\"0\":{\"roomId\":${bookingItem.rooms[0].roomId},\"ratePlanId\":${bookingItem.rooms[0].ratePlanId},\"addOnMap\":{},\"addchildMap\":{},\"policyChargeScope\":{}}}}}`,\n        };\n        return this.http.get(`${BASE_URL}api/be/rooms`, {\n            params: params,\n            headers: getDefaultHeaders(),\n        });\n    }\n    makePayment(bookingItem, personalDetails, payathotel) {\n        this.bookingService.setPGLoaderFlag();\n        let item = cloneDeep(bookingItem);\n        let postpayment = personalDetails.prepayment ? bookingItem.totalAmount - personalDetails.prepayment : 0;\n        // this.bookingService.removeCurrentBookingItemFromList()\n        let url1 = `https://app.axisrooms.com/beV2/hotelBooking.html?currency=1&`;\n        let url2 = `searchId=${item.searchId}&promoCodeApplied=&promoCode=&`;\n        let url3 = `tokenvalues=&master_pax_first_name=${personalDetails.firstName}&master_pax_last_name=${personalDetails.lastName}&`;\n        let url4 = `contactEmail=${personalDetails.emailId}&contactMobile=${personalDetails.mobileNo}&`;\n        let url5 = `additional_request=${personalDetails.specialRequest}&payAtHotelWithoutCC=${payathotel}&cardType=4&cardNO=&`;\n        let url6 = `cardValidity_month=&cardValidity_year=&cardHolderName=&cardValidity_cvv=&postAmountValue=` + postpayment;\n        let finalUrl = url1 + url2 + url3 + url4 + url5 + url6;\n        window.open(finalUrl, '_self');\n    }\n}\nPaymentService.ɵfac = function PaymentService_Factory(t) { return new (t || PaymentService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.BookingService)); };\nPaymentService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PaymentService, factory: PaymentService.ɵfac, providedIn: 'root' });\n"]},"metadata":{},"sourceType":"module"}