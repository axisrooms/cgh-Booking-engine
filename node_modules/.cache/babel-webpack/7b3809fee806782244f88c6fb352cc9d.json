{"ast":null,"code":"import _asyncToGenerator from \"/home/dileep/workspace/cgh-Booking-engine/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { __decorate } from \"tslib\";\nimport { Component, EventEmitter, Input, Output } from '@angular/core';\nimport { Validators } from '@angular/forms';\nimport { debounceTime, map, startWith } from 'rxjs/operators';\nimport * as moment from 'moment';\nimport { DateRange } from '@angular/material/datepicker';\nimport { DropdownType } from 'src/app/shared/models/dropdown-type';\nimport { formatDate } from '@angular/common';\nlet SearchComponent = class SearchComponent {\n  constructor(searchService, formBuilder, activatedRoute, router, spinner, dealsService, bookingService, bookingConfigService) {\n    this.searchService = searchService;\n    this.formBuilder = formBuilder;\n    this.activatedRoute = activatedRoute;\n    this.router = router;\n    this.spinner = spinner;\n    this.dealsService = dealsService;\n    this.bookingService = bookingService;\n    this.bookingConfigService = bookingConfigService;\n    this.dropdownType = DropdownType;\n    this.showDropdown = DropdownType.none;\n    this.showFieldWarnings = DropdownType.none;\n    this.age = new Map();\n    this.agesArray = Array.from({\n      length: 17\n    }, (_, i) => i + 1);\n    this.hotelsList = [];\n    this.isHotelListLoaded = false;\n    this.locationList = [];\n    this.isCurrentCalendarInputCheckout = false;\n    this.bookingItems = [];\n    this.selectedRangeValueChange = new EventEmitter();\n    this.now = new Date();\n    this.secondCalStartDate = new Date(this.now.getFullYear(), this.now.getMonth() + 1, 1);\n    this.calendarOneHeading = null;\n    this.calendarTwoHeading = null;\n    this.dateRangeSelectionType = 'exact';\n  }\n\n  ngOnInit() {\n    var _this = this;\n\n    this.bookingCart$ = this.bookingService.bookingCart$;\n    this.bookingCart$.subscribe(res => {\n      var _a;\n\n      this.bookingItems = (_a = res === null || res === void 0 ? void 0 : res.bookingItems) !== null && _a !== void 0 ? _a : [];\n    });\n    this.minDate = new Date();\n    this.searchForm = this.createSearchForm();\n    this.getWithExpiry();\n    this.filteredHotelsList = this.searchForm.controls.hotel.valueChanges.pipe(startWith(''), map(value => this.filterHotel(value)));\n    this.filteredLocationList = this.searchForm.controls.hotel.valueChanges.pipe(startWith(''), map(value => this.filterLocation(value)));\n    this.activateRouteSubscription$ = this.activatedRoute.queryParams.pipe(debounceTime(300)).subscribe( /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator(function* (queryParams) {\n        var _a, _b;\n\n        if (!queryParams['checkIn']) localStorage.removeItem('reflectStore');\n\n        if (queryParams['checkIn']) {\n          _this.roomCount = queryParams['rooms'];\n\n          _this.searchForm.patchValue({\n            checkIn: queryParams['checkIn'],\n            checkOut: queryParams['checkOut'],\n            cityId: (_a = queryParams['cityId']) !== null && _a !== void 0 ? _a : '',\n            stateId: queryParams['stateId'],\n            countryId: queryParams['countryId'],\n            searchType: (_b = queryParams['searchType']) !== null && _b !== void 0 ? _b : 'hotel'\n          });\n\n          yield _this.setHotelName(parseInt(queryParams['productId']));\n\n          _this.setLocation(queryParams['cityId'], queryParams['stateId']);\n\n          _this.setPaxInfo(queryParams['paxInfo']);\n\n          _this.fetchSearchResult();\n\n          _this.searchForm.controls.rooms.setValue(Number(localStorage.getItem('rooms')));\n        }\n      });\n\n      return function (_x) {\n        return _ref.apply(this, arguments);\n      };\n    }());\n  }\n\n  ngOnDestroy() {\n    var _a;\n\n    (_a = this.activateRouteSubscription$) === null || _a === void 0 ? void 0 : _a.unsubscribe();\n  }\n\n  createSearchForm() {\n    let dt = formatDate(new Date(), 'dd/MM/yyyy', 'en');\n    const tomorrow = new Date();\n    tomorrow.setDate(tomorrow.getDate() + 1);\n    let dtTom = formatDate(tomorrow, 'dd/MM/yyyy', 'en');\n    return this.formBuilder.group({\n      searchType: ['hotel'],\n      hotel: [''],\n      location: [''],\n      cityId: [''],\n      stateId: [''],\n      countryId: [''],\n      checkIn: [dt, Validators.required],\n      checkOut: [dtTom, Validators.required],\n      rooms: [1],\n      paxData: this.formBuilder.array([{\n        noOfAdults: 1,\n        noOfChildren: 0\n      }])\n    });\n  }\n\n  getTablesFormArray() {\n    return this.searchForm.get('paxData');\n  }\n  /** ---------- HOTEL FILTERING ---------- */\n\n\n  filterHotel(value) {\n    this.getWithExpiry();\n    if (!value) value = '';\n    let filterValue = value.toLowerCase();\n    let filtered = this.hotelsList.filter(val => {\n      var _a;\n\n      return (_a = val.hotel_name) === null || _a === void 0 ? void 0 : _a.toLowerCase().includes(filterValue);\n    });\n    this.showDropdown = filtered.length > 0 ? DropdownType.hotel : DropdownType.none;\n    return filtered;\n  }\n  /** ---------- LOCATION FILTERING ---------- */\n\n\n  filterLocation(value) {\n    this.getWithExpiry();\n    if (!value) value = '';\n    let filterValue = value.toLowerCase();\n    let filtered = this.locationList.filter(val => {\n      var _a;\n\n      return (_a = val.key) === null || _a === void 0 ? void 0 : _a.toLowerCase().includes(filterValue);\n    });\n    this.showDropdown = filtered.length > 0 ? DropdownType.location : DropdownType.none;\n    return filtered;\n  }\n  /** ---------- CACHE ---------- */\n\n\n  setWithExpiry(value) {\n    const item = {\n      value,\n      expiry: new Date().getTime()\n    };\n    localStorage.setItem('hotel', JSON.stringify(item));\n  }\n\n  getAllHotels() {\n    var _this2 = this;\n\n    return _asyncToGenerator(function* () {\n      yield _this2.searchService.getAllHotels().toPromise().then(res => {\n        _this2.setWithExpiry(res['Hotel_Details']);\n\n        _this2.getWithExpiry();\n      }).catch(err => console.error(err));\n    })();\n  }\n\n  getWithExpiry() {\n    const itemStr = localStorage.getItem('hotel');\n    if (this.flag == null) this.flag = true;\n\n    if (!itemStr && this.flag) {\n      this.getAllHotels();\n      this.flag = false;\n      return;\n    }\n\n    if (itemStr && this.flag) {\n      let item = JSON.parse(itemStr);\n\n      if (new Date().getTime() > item.expiry) {\n        localStorage.removeItem('hotel');\n        this.getAllHotels();\n        this.flag = false;\n        return;\n      }\n\n      this.hotelsList = item.value;\n      this.getLocationList(item.value);\n      this.isHotelListLoaded = true;\n    }\n  }\n  /** ---------- LOCATION LIST ---------- */\n\n\n  getLocationList(list) {\n    list.forEach(e1 => {\n      if (e1.address.city) {\n        let cityObj = {\n          key: e1.address.city,\n          type: 'city',\n          cityId: e1.address.cityId,\n          state: e1.address.state,\n          stateId: e1.address.stateId,\n          country: e1.address.country,\n          countryId: e1.address.countryId\n        };\n        if (!this.locationList.find(x => x.key === cityObj.key)) this.locationList.push(cityObj);\n      }\n\n      let stateObj = {\n        key: e1.address.state,\n        type: 'state',\n        stateId: e1.address.stateId,\n        country: e1.address.country,\n        countryId: e1.address.countryId\n      };\n      if (!this.locationList.find(x => x.key === stateObj.key)) this.locationList.push(stateObj);\n    });\n  }\n  /** ---------- DROPDOWNS ---------- */\n\n\n  toggleDropdown(type) {\n    this.showDropdown = this.showDropdown !== type ? type : DropdownType.none;\n    this.showFieldWarnings = DropdownType.none;\n  }\n  /** ---------- ROOMS & GUESTS ---------- */\n\n\n  updateRoomCount(type) {\n    let rooms = this.searchForm.controls.rooms.value;\n\n    if (type === 'decrement' && rooms > 1) {\n      this.searchForm.controls.rooms.setValue(rooms - 1);\n      this.getTablesFormArray().removeAt(rooms - 1);\n    }\n\n    if (type === 'increment') {\n      this.searchForm.controls.rooms.setValue(rooms + 1);\n      this.getTablesFormArray().push(this.formBuilder.group({\n        noOfAdults: 1,\n        noOfChildren: 0\n      }));\n    }\n\n    localStorage.setItem('rooms', this.searchForm.controls.rooms.value.toString());\n  }\n\n  updateAdultCount(type, index) {\n    let room = this.getTablesFormArray().at(index);\n    let current = room.value.noOfAdults;\n    if (type === 'increment') room.patchValue({\n      noOfAdults: current + 1\n    });\n    if (type === 'decrement' && current > 1) room.patchValue({\n      noOfAdults: current - 1\n    });\n  }\n\n  updateChildCount(type, index) {\n    let room = this.getTablesFormArray().at(index);\n    let current = room.value.noOfChildren;\n\n    if (type === 'increment' && current < 3) {\n      room.patchValue({\n        noOfChildren: current + 1\n      });\n      this.age.set(`${index}_${current}`, 1);\n    }\n\n    if (type === 'decrement' && current > 0) {\n      room.patchValue({\n        noOfChildren: current - 1\n      });\n      this.age.delete(`${index}_${current - 1}`);\n    }\n  }\n\n  addAges(event, room, child) {\n    this.age.set(`${room}_${child}`, event.target.value);\n  }\n  /** ---------- SELECTION ---------- */\n\n\n  selectHotel(name) {\n    this.searchForm.controls.hotel.setValue(name);\n    this.showDropdown = DropdownType.none;\n  }\n\n  selectLocation(option) {\n    var _a;\n\n    this.searchForm.patchValue({\n      hotel: option.key,\n      cityId: (_a = option.cityId) !== null && _a !== void 0 ? _a : '',\n      stateId: option.stateId,\n      countryId: option.countryId,\n      location: option.key,\n      searchType: 'location'\n    });\n    this.showDropdown = DropdownType.none;\n  }\n\n  setHotelName(id) {\n    var _this3 = this;\n\n    return _asyncToGenerator(function* () {\n      _this3.getWithExpiry();\n\n      let match = _this3.hotelsList.find(h => h.hotel_id === id);\n\n      if (match) _this3.searchForm.controls.hotel.setValue(match.hotel_name);\n    })();\n  }\n\n  setLocation(cityId, stateId) {\n    let location = '';\n\n    for (let loc of this.locationList) {\n      if (cityId && loc.cityId === cityId) location = loc.key;else if (!cityId && loc.stateId === stateId) location = loc.key;\n    }\n\n    this.searchForm.controls.location.setValue(location);\n  }\n  /** ---------- PAX INFO ---------- */\n\n\n  getPaxInfo() {\n    let paxString = '';\n    let guests = 0;\n    let arr = this.getTablesFormArray().value;\n\n    for (let i = 0; i < arr.length; i++) {\n      paxString += arr[i].noOfAdults + '|' + arr[i].noOfChildren + '|';\n      guests += arr[i].noOfAdults + arr[i].noOfChildren;\n\n      for (let c = 0; c < arr[i].noOfChildren; c++) {\n        paxString += this.age.get(`${i}_${c}`) + '|';\n      }\n\n      paxString += '|';\n    }\n\n    localStorage.setItem('guests', guests.toString());\n    return paxString;\n  }\n\n  setPaxInfo(info) {// optional (not implemented in original code)\n  }\n  /** ---------- SUBMIT / SEARCH ---------- */\n\n\n  onSubmit() {\n    this.searchForm.markAllAsTouched();\n    this.showDropdown = DropdownType.none;\n\n    if (this.searchForm.valid) {\n      let prevUrl = this.router.url;\n      let params = this.getSearchParams();\n      params.searchType = this.searchForm.controls.searchType.value;\n      this.router.navigate(['/search'], {\n        queryParams: params\n      }).then(res => {\n        if (prevUrl === this.router.url) this.scrollToSearchView();\n      });\n    }\n  }\n\n  getSearchParams() {\n    let params = {\n      bookingEngineId: this.bookingConfigService.getBookingEngineId(),\n      hotelId: this.bookingConfigService.getBookingEngineId()\n    };\n    params.productId = this.getProductId();\n    params.cityId = this.searchForm.controls.cityId.value;\n    params.checkIn = this.searchForm.controls.checkIn.value;\n    params.checkOut = this.searchForm.controls.checkOut.value;\n    params.paxInfo = this.getPaxInfo();\n    return params;\n  }\n\n  getProductId() {\n    var _a;\n\n    let name = this.searchForm.controls.hotel.value;\n    let hotel = this.hotelsList.find(h => h.hotel_name === name);\n    return (_a = hotel === null || hotel === void 0 ? void 0 : hotel.hotel_id) !== null && _a !== void 0 ? _a : null;\n  }\n\n  fetchSearchResult() {\n    if (!this.searchForm.valid) return;\n    this.spinner.show();\n    let params = this.getSearchParams();\n    this.searchService.searchRooms(params).subscribe(res => {\n      this.searchResponse = res;\n      this.searchId = res['search_id'];\n      this.scrollToSearchView();\n      this.spinner.hide();\n    });\n  }\n\n  scrollToSearchView() {\n    let el = document.getElementById('searchTitleId');\n    if (!el) return;\n    let offset = el.getBoundingClientRect().top + window.pageYOffset - 250;\n    window.scrollTo({\n      top: offset,\n      behavior: 'smooth'\n    });\n  }\n\n  onChangeMonth(type) {\n    var _a, _b;\n\n    let classname = type === 'next' ? 'mat-calendar-next-button' : 'mat-calendar-previous-button';\n    let arrows = document.getElementsByClassName(classname);\n    (_a = arrows[0]) === null || _a === void 0 ? void 0 : _a.click();\n    (_b = arrows[1]) === null || _b === void 0 ? void 0 : _b.click();\n    this.updateHeaderText();\n  }\n\n  updateHeaderText() {\n    setTimeout(() => {\n      var _a, _b, _c, _d;\n\n      let btns = document.getElementsByClassName('mat-calendar-period-button');\n      this.calendarOneHeading = (_b = (_a = btns[0]) === null || _a === void 0 ? void 0 : _a.innerText) !== null && _b !== void 0 ? _b : null;\n      this.calendarTwoHeading = (_d = (_c = btns[1]) === null || _c === void 0 ? void 0 : _c.innerText) !== null && _d !== void 0 ? _d : null;\n    }, 0);\n  }\n\n  selectedChange(date) {\n    var _a, _b;\n\n    if (!((_a = this.selectedRangeValue) === null || _a === void 0 ? void 0 : _a.start) || ((_b = this.selectedRangeValue) === null || _b === void 0 ? void 0 : _b.end)) {\n      if (this.dateRangeSelectionType === 'exact') {\n        this.selectedRangeValue = new DateRange(date, null);\n        this.updateDate('checkin', date);\n        this.isCurrentCalendarInputCheckout = true;\n      } else {\n        let days = parseInt(this.dateRangeSelectionType);\n        let checkout = this.addDays(date, days);\n        this.selectedRangeValue = new DateRange(date, checkout);\n        this.updateDate('checkin', date);\n        this.updateDate('checkout', checkout);\n        this.showDropdown = DropdownType.none;\n      }\n    } else {\n      let start = this.selectedRangeValue.start;\n      let end = date;\n\n      if (end < start) {\n        this.selectedRangeValue = new DateRange(end, start);\n        this.updateDate('checkin', end);\n        this.updateDate('checkout', start);\n      } else {\n        this.selectedRangeValue = new DateRange(start, end);\n        this.updateDate('checkin', start);\n        this.updateDate('checkout', end);\n      }\n\n      this.showDropdown = DropdownType.none;\n    }\n\n    this.selectedRangeValueChange.emit(this.selectedRangeValue);\n  }\n\n  updateDate(type, date) {\n    let formatted = moment(date).format('DD/MM/YYYY');\n\n    if (type === 'checkin') {\n      this.searchForm.controls.checkIn.setValue(formatted);\n      this.searchForm.controls.checkOut.setValue(null);\n    } else {\n      this.searchForm.controls.checkOut.setValue(formatted);\n    }\n  }\n\n  addDays(date, days) {\n    let result = new Date(date);\n    result.setDate(result.getDate() + days);\n    return result;\n  }\n\n};\n\n__decorate([Input()], SearchComponent.prototype, \"selectedRangeValue\", void 0);\n\n__decorate([Output()], SearchComponent.prototype, \"selectedRangeValueChange\", void 0);\n\nSearchComponent = __decorate([Component({\n  selector: 'app-search',\n  templateUrl: './search.component.html',\n  styleUrls: ['./search.component.css']\n})], SearchComponent);\nexport { SearchComponent };","map":{"version":3,"sources":["/home/dileep/workspace/cgh-Booking-engine/src/app/pages/search/search.component.ts"],"names":["__decorate","Component","EventEmitter","Input","Output","Validators","debounceTime","map","startWith","moment","DateRange","DropdownType","formatDate","SearchComponent","constructor","searchService","formBuilder","activatedRoute","router","spinner","dealsService","bookingService","bookingConfigService","dropdownType","showDropdown","none","showFieldWarnings","age","Map","agesArray","Array","from","length","_","i","hotelsList","isHotelListLoaded","locationList","isCurrentCalendarInputCheckout","bookingItems","selectedRangeValueChange","now","Date","secondCalStartDate","getFullYear","getMonth","calendarOneHeading","calendarTwoHeading","dateRangeSelectionType","ngOnInit","bookingCart$","subscribe","res","_a","minDate","searchForm","createSearchForm","getWithExpiry","filteredHotelsList","controls","hotel","valueChanges","pipe","value","filterHotel","filteredLocationList","filterLocation","activateRouteSubscription$","queryParams","_b","localStorage","removeItem","roomCount","patchValue","checkIn","checkOut","cityId","stateId","countryId","searchType","setHotelName","parseInt","setLocation","setPaxInfo","fetchSearchResult","rooms","setValue","Number","getItem","ngOnDestroy","unsubscribe","dt","tomorrow","setDate","getDate","dtTom","group","location","required","paxData","array","noOfAdults","noOfChildren","getTablesFormArray","get","filterValue","toLowerCase","filtered","filter","val","hotel_name","includes","key","setWithExpiry","item","expiry","getTime","setItem","JSON","stringify","getAllHotels","toPromise","then","catch","err","console","error","itemStr","flag","parse","getLocationList","list","forEach","e1","address","city","cityObj","type","state","country","find","x","push","stateObj","toggleDropdown","updateRoomCount","removeAt","toString","updateAdultCount","index","room","at","current","updateChildCount","set","delete","addAges","event","child","target","selectHotel","name","selectLocation","option","id","match","h","hotel_id","loc","getPaxInfo","paxString","guests","arr","c","info","onSubmit","markAllAsTouched","valid","prevUrl","url","params","getSearchParams","navigate","scrollToSearchView","bookingEngineId","getBookingEngineId","hotelId","productId","getProductId","paxInfo","show","searchRooms","searchResponse","searchId","hide","el","document","getElementById","offset","getBoundingClientRect","top","window","pageYOffset","scrollTo","behavior","onChangeMonth","classname","arrows","getElementsByClassName","click","updateHeaderText","setTimeout","_c","_d","btns","innerText","selectedChange","date","selectedRangeValue","start","end","updateDate","days","checkout","addDays","emit","formatted","format","result","prototype","selector","templateUrl","styleUrls"],"mappings":"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","sourcesContent":["import { __decorate } from \"tslib\";\nimport { Component, EventEmitter, Input, Output, } from '@angular/core';\nimport { Validators, } from '@angular/forms';\nimport { debounceTime, map, startWith } from 'rxjs/operators';\nimport * as moment from 'moment';\nimport { DateRange } from '@angular/material/datepicker';\nimport { DropdownType } from 'src/app/shared/models/dropdown-type';\nimport { formatDate } from '@angular/common';\nlet SearchComponent = class SearchComponent {\n    constructor(searchService, formBuilder, activatedRoute, router, spinner, dealsService, bookingService, bookingConfigService) {\n        this.searchService = searchService;\n        this.formBuilder = formBuilder;\n        this.activatedRoute = activatedRoute;\n        this.router = router;\n        this.spinner = spinner;\n        this.dealsService = dealsService;\n        this.bookingService = bookingService;\n        this.bookingConfigService = bookingConfigService;\n        this.dropdownType = DropdownType;\n        this.showDropdown = DropdownType.none;\n        this.showFieldWarnings = DropdownType.none;\n        this.age = new Map();\n        this.agesArray = Array.from({ length: 17 }, (_, i) => i + 1);\n        this.hotelsList = [];\n        this.isHotelListLoaded = false;\n        this.locationList = [];\n        this.isCurrentCalendarInputCheckout = false;\n        this.bookingItems = [];\n        this.selectedRangeValueChange = new EventEmitter();\n        this.now = new Date();\n        this.secondCalStartDate = new Date(this.now.getFullYear(), this.now.getMonth() + 1, 1);\n        this.calendarOneHeading = null;\n        this.calendarTwoHeading = null;\n        this.dateRangeSelectionType = 'exact';\n    }\n    ngOnInit() {\n        this.bookingCart$ = this.bookingService.bookingCart$;\n        this.bookingCart$.subscribe((res) => {\n            var _a;\n            this.bookingItems = (_a = res === null || res === void 0 ? void 0 : res.bookingItems) !== null && _a !== void 0 ? _a : [];\n        });\n        this.minDate = new Date();\n        this.searchForm = this.createSearchForm();\n        this.getWithExpiry();\n        this.filteredHotelsList = this.searchForm.controls.hotel.valueChanges.pipe(startWith(''), map((value) => this.filterHotel(value)));\n        this.filteredLocationList =\n            this.searchForm.controls.hotel.valueChanges.pipe(startWith(''), map((value) => this.filterLocation(value)));\n        this.activateRouteSubscription$ =\n            this.activatedRoute.queryParams.pipe(debounceTime(300)).subscribe(async (queryParams) => {\n                var _a, _b;\n                if (!queryParams['checkIn'])\n                    localStorage.removeItem('reflectStore');\n                if (queryParams['checkIn']) {\n                    this.roomCount = queryParams['rooms'];\n                    this.searchForm.patchValue({\n                        checkIn: queryParams['checkIn'],\n                        checkOut: queryParams['checkOut'],\n                        cityId: (_a = queryParams['cityId']) !== null && _a !== void 0 ? _a : '',\n                        stateId: queryParams['stateId'],\n                        countryId: queryParams['countryId'],\n                        searchType: (_b = queryParams['searchType']) !== null && _b !== void 0 ? _b : 'hotel',\n                    });\n                    await this.setHotelName(parseInt(queryParams['productId']));\n                    this.setLocation(queryParams['cityId'], queryParams['stateId']);\n                    this.setPaxInfo(queryParams['paxInfo']);\n                    this.fetchSearchResult();\n                    this.searchForm.controls.rooms.setValue(Number(localStorage.getItem('rooms')));\n                }\n            });\n    }\n    ngOnDestroy() {\n        var _a;\n        (_a = this.activateRouteSubscription$) === null || _a === void 0 ? void 0 : _a.unsubscribe();\n    }\n    createSearchForm() {\n        let dt = formatDate(new Date(), 'dd/MM/yyyy', 'en');\n        const tomorrow = new Date();\n        tomorrow.setDate(tomorrow.getDate() + 1);\n        let dtTom = formatDate(tomorrow, 'dd/MM/yyyy', 'en');\n        return this.formBuilder.group({\n            searchType: ['hotel'],\n            hotel: [''],\n            location: [''],\n            cityId: [''],\n            stateId: [''],\n            countryId: [''],\n            checkIn: [dt, Validators.required],\n            checkOut: [dtTom, Validators.required],\n            rooms: [1],\n            paxData: this.formBuilder.array([\n                {\n                    noOfAdults: 1,\n                    noOfChildren: 0,\n                },\n            ]),\n        });\n    }\n    getTablesFormArray() {\n        return this.searchForm.get('paxData');\n    }\n    /** ---------- HOTEL FILTERING ---------- */\n    filterHotel(value) {\n        this.getWithExpiry();\n        if (!value)\n            value = '';\n        let filterValue = value.toLowerCase();\n        let filtered = this.hotelsList.filter((val) => { var _a; return (_a = val.hotel_name) === null || _a === void 0 ? void 0 : _a.toLowerCase().includes(filterValue); });\n        this.showDropdown =\n            filtered.length > 0 ? DropdownType.hotel : DropdownType.none;\n        return filtered;\n    }\n    /** ---------- LOCATION FILTERING ---------- */\n    filterLocation(value) {\n        this.getWithExpiry();\n        if (!value)\n            value = '';\n        let filterValue = value.toLowerCase();\n        let filtered = this.locationList.filter((val) => { var _a; return (_a = val.key) === null || _a === void 0 ? void 0 : _a.toLowerCase().includes(filterValue); });\n        this.showDropdown =\n            filtered.length > 0 ? DropdownType.location : DropdownType.none;\n        return filtered;\n    }\n    /** ---------- CACHE ---------- */\n    setWithExpiry(value) {\n        const item = {\n            value,\n            expiry: new Date().getTime(),\n        };\n        localStorage.setItem('hotel', JSON.stringify(item));\n    }\n    async getAllHotels() {\n        await this.searchService\n            .getAllHotels()\n            .toPromise()\n            .then((res) => {\n            this.setWithExpiry(res['Hotel_Details']);\n            this.getWithExpiry();\n        })\n            .catch((err) => console.error(err));\n    }\n    getWithExpiry() {\n        const itemStr = localStorage.getItem('hotel');\n        if (this.flag == null)\n            this.flag = true;\n        if (!itemStr && this.flag) {\n            this.getAllHotels();\n            this.flag = false;\n            return;\n        }\n        if (itemStr && this.flag) {\n            let item = JSON.parse(itemStr);\n            if (new Date().getTime() > item.expiry) {\n                localStorage.removeItem('hotel');\n                this.getAllHotels();\n                this.flag = false;\n                return;\n            }\n            this.hotelsList = item.value;\n            this.getLocationList(item.value);\n            this.isHotelListLoaded = true;\n        }\n    }\n    /** ---------- LOCATION LIST ---------- */\n    getLocationList(list) {\n        list.forEach((e1) => {\n            if (e1.address.city) {\n                let cityObj = {\n                    key: e1.address.city,\n                    type: 'city',\n                    cityId: e1.address.cityId,\n                    state: e1.address.state,\n                    stateId: e1.address.stateId,\n                    country: e1.address.country,\n                    countryId: e1.address.countryId,\n                };\n                if (!this.locationList.find((x) => x.key === cityObj.key))\n                    this.locationList.push(cityObj);\n            }\n            let stateObj = {\n                key: e1.address.state,\n                type: 'state',\n                stateId: e1.address.stateId,\n                country: e1.address.country,\n                countryId: e1.address.countryId,\n            };\n            if (!this.locationList.find((x) => x.key === stateObj.key))\n                this.locationList.push(stateObj);\n        });\n    }\n    /** ---------- DROPDOWNS ---------- */\n    toggleDropdown(type) {\n        this.showDropdown = this.showDropdown !== type ? type : DropdownType.none;\n        this.showFieldWarnings = DropdownType.none;\n    }\n    /** ---------- ROOMS & GUESTS ---------- */\n    updateRoomCount(type) {\n        let rooms = this.searchForm.controls.rooms.value;\n        if (type === 'decrement' && rooms > 1) {\n            this.searchForm.controls.rooms.setValue(rooms - 1);\n            this.getTablesFormArray().removeAt(rooms - 1);\n        }\n        if (type === 'increment') {\n            this.searchForm.controls.rooms.setValue(rooms + 1);\n            this.getTablesFormArray().push(this.formBuilder.group({\n                noOfAdults: 1,\n                noOfChildren: 0,\n            }));\n        }\n        localStorage.setItem('rooms', this.searchForm.controls.rooms.value.toString());\n    }\n    updateAdultCount(type, index) {\n        let room = this.getTablesFormArray().at(index);\n        let current = room.value.noOfAdults;\n        if (type === 'increment')\n            room.patchValue({ noOfAdults: current + 1 });\n        if (type === 'decrement' && current > 1)\n            room.patchValue({ noOfAdults: current - 1 });\n    }\n    updateChildCount(type, index) {\n        let room = this.getTablesFormArray().at(index);\n        let current = room.value.noOfChildren;\n        if (type === 'increment' && current < 3) {\n            room.patchValue({ noOfChildren: current + 1 });\n            this.age.set(`${index}_${current}`, 1);\n        }\n        if (type === 'decrement' && current > 0) {\n            room.patchValue({ noOfChildren: current - 1 });\n            this.age.delete(`${index}_${current - 1}`);\n        }\n    }\n    addAges(event, room, child) {\n        this.age.set(`${room}_${child}`, event.target.value);\n    }\n    /** ---------- SELECTION ---------- */\n    selectHotel(name) {\n        this.searchForm.controls.hotel.setValue(name);\n        this.showDropdown = DropdownType.none;\n    }\n    selectLocation(option) {\n        var _a;\n        this.searchForm.patchValue({\n            hotel: option.key,\n            cityId: (_a = option.cityId) !== null && _a !== void 0 ? _a : '',\n            stateId: option.stateId,\n            countryId: option.countryId,\n            location: option.key,\n            searchType: 'location',\n        });\n        this.showDropdown = DropdownType.none;\n    }\n    async setHotelName(id) {\n        this.getWithExpiry();\n        let match = this.hotelsList.find((h) => h.hotel_id === id);\n        if (match)\n            this.searchForm.controls.hotel.setValue(match.hotel_name);\n    }\n    setLocation(cityId, stateId) {\n        let location = '';\n        for (let loc of this.locationList) {\n            if (cityId && loc.cityId === cityId)\n                location = loc.key;\n            else if (!cityId && loc.stateId === stateId)\n                location = loc.key;\n        }\n        this.searchForm.controls.location.setValue(location);\n    }\n    /** ---------- PAX INFO ---------- */\n    getPaxInfo() {\n        let paxString = '';\n        let guests = 0;\n        let arr = this.getTablesFormArray().value;\n        for (let i = 0; i < arr.length; i++) {\n            paxString += arr[i].noOfAdults + '|' + arr[i].noOfChildren + '|';\n            guests += arr[i].noOfAdults + arr[i].noOfChildren;\n            for (let c = 0; c < arr[i].noOfChildren; c++) {\n                paxString += this.age.get(`${i}_${c}`) + '|';\n            }\n            paxString += '|';\n        }\n        localStorage.setItem('guests', guests.toString());\n        return paxString;\n    }\n    setPaxInfo(info) {\n        // optional (not implemented in original code)\n    }\n    /** ---------- SUBMIT / SEARCH ---------- */\n    onSubmit() {\n        this.searchForm.markAllAsTouched();\n        this.showDropdown = DropdownType.none;\n        if (this.searchForm.valid) {\n            let prevUrl = this.router.url;\n            let params = this.getSearchParams();\n            params.searchType = this.searchForm.controls.searchType.value;\n            this.router.navigate(['/search'], { queryParams: params }).then((res) => {\n                if (prevUrl === this.router.url)\n                    this.scrollToSearchView();\n            });\n        }\n    }\n    getSearchParams() {\n        let params = {\n            bookingEngineId: this.bookingConfigService.getBookingEngineId(),\n            hotelId: this.bookingConfigService.getBookingEngineId(),\n        };\n        params.productId = this.getProductId();\n        params.cityId = this.searchForm.controls.cityId.value;\n        params.checkIn = this.searchForm.controls.checkIn.value;\n        params.checkOut = this.searchForm.controls.checkOut.value;\n        params.paxInfo = this.getPaxInfo();\n        return params;\n    }\n    getProductId() {\n        var _a;\n        let name = this.searchForm.controls.hotel.value;\n        let hotel = this.hotelsList.find((h) => h.hotel_name === name);\n        return (_a = hotel === null || hotel === void 0 ? void 0 : hotel.hotel_id) !== null && _a !== void 0 ? _a : null;\n    }\n    fetchSearchResult() {\n        if (!this.searchForm.valid)\n            return;\n        this.spinner.show();\n        let params = this.getSearchParams();\n        this.searchService.searchRooms(params).subscribe((res) => {\n            this.searchResponse = res;\n            this.searchId = res['search_id'];\n            this.scrollToSearchView();\n            this.spinner.hide();\n        });\n    }\n    scrollToSearchView() {\n        let el = document.getElementById('searchTitleId');\n        if (!el)\n            return;\n        let offset = el.getBoundingClientRect().top + window.pageYOffset - 250;\n        window.scrollTo({\n            top: offset,\n            behavior: 'smooth',\n        });\n    }\n    onChangeMonth(type) {\n        var _a, _b;\n        let classname = type === 'next'\n            ? 'mat-calendar-next-button'\n            : 'mat-calendar-previous-button';\n        let arrows = document.getElementsByClassName(classname);\n        (_a = arrows[0]) === null || _a === void 0 ? void 0 : _a.click();\n        (_b = arrows[1]) === null || _b === void 0 ? void 0 : _b.click();\n        this.updateHeaderText();\n    }\n    updateHeaderText() {\n        setTimeout(() => {\n            var _a, _b, _c, _d;\n            let btns = document.getElementsByClassName('mat-calendar-period-button');\n            this.calendarOneHeading = (_b = (_a = btns[0]) === null || _a === void 0 ? void 0 : _a.innerText) !== null && _b !== void 0 ? _b : null;\n            this.calendarTwoHeading = (_d = (_c = btns[1]) === null || _c === void 0 ? void 0 : _c.innerText) !== null && _d !== void 0 ? _d : null;\n        }, 0);\n    }\n    selectedChange(date) {\n        var _a, _b;\n        if (!((_a = this.selectedRangeValue) === null || _a === void 0 ? void 0 : _a.start) || ((_b = this.selectedRangeValue) === null || _b === void 0 ? void 0 : _b.end)) {\n            if (this.dateRangeSelectionType === 'exact') {\n                this.selectedRangeValue = new DateRange(date, null);\n                this.updateDate('checkin', date);\n                this.isCurrentCalendarInputCheckout = true;\n            }\n            else {\n                let days = parseInt(this.dateRangeSelectionType);\n                let checkout = this.addDays(date, days);\n                this.selectedRangeValue = new DateRange(date, checkout);\n                this.updateDate('checkin', date);\n                this.updateDate('checkout', checkout);\n                this.showDropdown = DropdownType.none;\n            }\n        }\n        else {\n            let start = this.selectedRangeValue.start;\n            let end = date;\n            if (end < start) {\n                this.selectedRangeValue = new DateRange(end, start);\n                this.updateDate('checkin', end);\n                this.updateDate('checkout', start);\n            }\n            else {\n                this.selectedRangeValue = new DateRange(start, end);\n                this.updateDate('checkin', start);\n                this.updateDate('checkout', end);\n            }\n            this.showDropdown = DropdownType.none;\n        }\n        this.selectedRangeValueChange.emit(this.selectedRangeValue);\n    }\n    updateDate(type, date) {\n        let formatted = moment(date).format('DD/MM/YYYY');\n        if (type === 'checkin') {\n            this.searchForm.controls.checkIn.setValue(formatted);\n            this.searchForm.controls.checkOut.setValue(null);\n        }\n        else {\n            this.searchForm.controls.checkOut.setValue(formatted);\n        }\n    }\n    addDays(date, days) {\n        let result = new Date(date);\n        result.setDate(result.getDate() + days);\n        return result;\n    }\n};\n__decorate([\n    Input()\n], SearchComponent.prototype, \"selectedRangeValue\", void 0);\n__decorate([\n    Output()\n], SearchComponent.prototype, \"selectedRangeValueChange\", void 0);\nSearchComponent = __decorate([\n    Component({\n        selector: 'app-search',\n        templateUrl: './search.component.html',\n        styleUrls: ['./search.component.css'],\n    })\n], SearchComponent);\nexport { SearchComponent };\n"]},"metadata":{},"sourceType":"module"}