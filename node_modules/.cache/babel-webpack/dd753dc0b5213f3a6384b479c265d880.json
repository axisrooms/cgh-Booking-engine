{"ast":null,"code":"import _asyncToGenerator from \"/home/dileep/workspace/cgh-Booking-engine/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { BASE_URL, getDefaultHeaders } from '../shared/constants/url.constants';\nimport { cloneDeep } from 'lodash-es';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./booking.service\";\nimport * as i3 from \"src/app/services/bookingid.service\";\nexport class PaymentService {\n  constructor(http, bookingService, BookingConfigService) {\n    this.http = http;\n    this.bookingService = bookingService;\n    this.BookingConfigService = BookingConfigService;\n  }\n\n  createOrderAndMakePayment(bookingItem, personalDetailsForm, payathotel) {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      console.log(bookingItem, personalDetailsForm, payathotel, \"!!!!!\");\n\n      _this.createOrder(bookingItem).subscribe(res1 => {\n        _this.makePayment(bookingItem, personalDetailsForm, payathotel);\n      });\n    })();\n  }\n\n  createOrder(bookingItem) {\n    let params = {\n      bookingEngineId: this.BookingConfigService.getBookingEngineId(),\n      productId: bookingItem.hotelId,\n      searchId: bookingItem.searchId,\n      checkIn: bookingItem.checkIn,\n      checkOut: bookingItem.checkOut,\n      cityId: bookingItem.renderData.address.cityId,\n      paxInfo: bookingItem.paxInfo,\n      selectedrooms: `{\"1\":{\"productId\":${bookingItem.hotelId},\"roomMap\":{\"0\":{\"roomId\":${bookingItem.rooms[0].roomId},\"ratePlanId\":${bookingItem.rooms[0].ratePlanId},\"addOnMap\":{},\"addchildMap\":{},\"policyChargeScope\":{}}}}}`\n    };\n    return this.http.get(`${BASE_URL}api/be/rooms`, {\n      params: params,\n      headers: getDefaultHeaders()\n    });\n  }\n\n  makePayment(bookingItem, personalDetails, payathotel) {\n    this.bookingService.setPGLoaderFlag();\n    let item = cloneDeep(bookingItem);\n    let postpayment = personalDetails.prepayment ? bookingItem.totalAmount - personalDetails.prepayment : 0; // this.bookingService.removeCurrentBookingItemFromList()\n\n    let url1 = `https://app.axisrooms.com/beV2/hotelBooking.html?currency=1&`;\n    let url2 = `searchId=${item.searchId}&promoCodeApplied=&promoCode=&`;\n    let url3 = `tokenvalues=&master_pax_first_name=${personalDetails.firstName}&master_pax_last_name=${personalDetails.lastName}&`;\n    let url4 = `contactEmail=${personalDetails.emailId}&contactMobile=${personalDetails.mobileNo}&`;\n    let url5 = `additional_request=${personalDetails.specialRequest}&payAtHotelWithCC=${payathotel}&cardType=4&cardNO=&`;\n    let url6 = `cardValidity_month=&cardValidity_year=&cardHolderName=&cardValidity_cvv=&postAmountValue=` + postpayment;\n    let finalUrl = url1 + url2 + url3 + url4 + url5 + url6;\n    window.open(finalUrl, '_self');\n  }\n\n}\n\nPaymentService.ɵfac = function PaymentService_Factory(t) {\n  return new (t || PaymentService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.BookingService), i0.ɵɵinject(i3.BookingConfigService));\n};\n\nPaymentService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: PaymentService,\n  factory: PaymentService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"sources":["/home/dileep/workspace/cgh-Booking-engine/src/app/services/payment.service.ts"],"names":["BASE_URL","getDefaultHeaders","cloneDeep","i0","i1","i2","i3","PaymentService","constructor","http","bookingService","BookingConfigService","createOrderAndMakePayment","bookingItem","personalDetailsForm","payathotel","console","log","createOrder","subscribe","res1","makePayment","params","bookingEngineId","getBookingEngineId","productId","hotelId","searchId","checkIn","checkOut","cityId","renderData","address","paxInfo","selectedrooms","rooms","roomId","ratePlanId","get","headers","personalDetails","setPGLoaderFlag","item","postpayment","prepayment","totalAmount","url1","url2","url3","firstName","lastName","url4","emailId","mobileNo","url5","specialRequest","url6","finalUrl","window","open","ɵfac","PaymentService_Factory","t","ɵɵinject","HttpClient","BookingService","ɵprov","ɵɵdefineInjectable","token","factory","providedIn"],"mappings":"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","sourcesContent":["import { BASE_URL, getDefaultHeaders, } from '../shared/constants/url.constants';\nimport { cloneDeep } from 'lodash-es';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./booking.service\";\nimport * as i3 from \"src/app/services/bookingid.service\";\nexport class PaymentService {\n    constructor(http, bookingService, BookingConfigService) {\n        this.http = http;\n        this.bookingService = bookingService;\n        this.BookingConfigService = BookingConfigService;\n    }\n    async createOrderAndMakePayment(bookingItem, personalDetailsForm, payathotel) {\n        console.log(bookingItem, personalDetailsForm, payathotel, \"!!!!!\");\n        this.createOrder(bookingItem).subscribe((res1) => {\n            this.makePayment(bookingItem, personalDetailsForm, payathotel);\n        });\n    }\n    createOrder(bookingItem) {\n        let params = {\n            bookingEngineId: this.BookingConfigService.getBookingEngineId(),\n            productId: bookingItem.hotelId,\n            searchId: bookingItem.searchId,\n            checkIn: bookingItem.checkIn,\n            checkOut: bookingItem.checkOut,\n            cityId: bookingItem.renderData.address.cityId,\n            paxInfo: bookingItem.paxInfo,\n            selectedrooms: `{\"1\":{\"productId\":${bookingItem.hotelId},\"roomMap\":{\"0\":{\"roomId\":${bookingItem.rooms[0].roomId},\"ratePlanId\":${bookingItem.rooms[0].ratePlanId},\"addOnMap\":{},\"addchildMap\":{},\"policyChargeScope\":{}}}}}`,\n        };\n        return this.http.get(`${BASE_URL}api/be/rooms`, {\n            params: params,\n            headers: getDefaultHeaders(),\n        });\n    }\n    makePayment(bookingItem, personalDetails, payathotel) {\n        this.bookingService.setPGLoaderFlag();\n        let item = cloneDeep(bookingItem);\n        let postpayment = personalDetails.prepayment ? bookingItem.totalAmount - personalDetails.prepayment : 0;\n        // this.bookingService.removeCurrentBookingItemFromList()\n        let url1 = `https://app.axisrooms.com/beV2/hotelBooking.html?currency=1&`;\n        let url2 = `searchId=${item.searchId}&promoCodeApplied=&promoCode=&`;\n        let url3 = `tokenvalues=&master_pax_first_name=${personalDetails.firstName}&master_pax_last_name=${personalDetails.lastName}&`;\n        let url4 = `contactEmail=${personalDetails.emailId}&contactMobile=${personalDetails.mobileNo}&`;\n        let url5 = `additional_request=${personalDetails.specialRequest}&payAtHotelWithCC=${payathotel}&cardType=4&cardNO=&`;\n        let url6 = `cardValidity_month=&cardValidity_year=&cardHolderName=&cardValidity_cvv=&postAmountValue=` + postpayment;\n        let finalUrl = url1 + url2 + url3 + url4 + url5 + url6;\n        window.open(finalUrl, '_self');\n    }\n}\nPaymentService.ɵfac = function PaymentService_Factory(t) { return new (t || PaymentService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.BookingService), i0.ɵɵinject(i3.BookingConfigService)); };\nPaymentService.ɵprov = /*@__PURE__*/ i0.ɵɵdefineInjectable({ token: PaymentService, factory: PaymentService.ɵfac, providedIn: 'root' });\n"]},"metadata":{},"sourceType":"module"}